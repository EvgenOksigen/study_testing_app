{"ast":null,"code":"var _jsxFileName = \"/home/evgeny/Public/reduxtraine/my-app/src/views/pages/Trello/TaskItem.js\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { taskComplete } from '../../../state/ducks/task/actions';\n\nconst TaskItem = ({\n  task,\n  index,\n  taskComplete\n}) => {\n  const dragNDrop = e => {\n    const dragItem = e.target;\n\n    dragItem.ondragstart = function () {\n      return false;\n    };\n\n    let currentDroppable = null;\n\n    dragItem.onmousedown = e => {\n      dragItem.style.position = 'relative';\n      dragItem.style.zIndex = 1000;\n      let shiftX = e.clientX - dragItem.getBoundingClientRect().left;\n      let shiftY = e.clientY - dragItem.getBoundingClientRect().top;\n      let taskList = document.getElementsByClassName('taskList')[0];\n      taskList.append(dragItem);\n      moveAt(e.pageX, e.pageY);\n\n      function moveAt(pageX, pageY) {\n        dragItem.style.left = pageX - shiftX + 'px';\n        dragItem.style.top = pageY - shiftY + 'px';\n      }\n\n      function onMouseMove(e) {\n        moveAt(e.pageX, e.pageY);\n        console.log(currentDroppable);\n        dragItem.hidden = true;\n        let elemBelow = document.elementFromPoint(e.clientX, e.clientY);\n        dragItem.hidden = false;\n        if (!elemBelow) return; // предположительная точка \"посадки\" Drag’n’Drop функции \n\n        let droppableBelow = elemBelow.closest('.finished');\n        let droppableBelowBack = elemBelow.closest('.not-finished');\n\n        if (currentDroppable != droppableBelow) {\n          if (currentDroppable) {\n            // логика обработки процесса \"вылета\" из finished (удаляем подсветку)\n            leaveDroppable(currentDroppable);\n          }\n\n          currentDroppable = droppableBelow;\n\n          if (currentDroppable) {\n            // логика обработки процесса, когда мы \"влетаем\" в элемент finished\n            enterDroppable(currentDroppable);\n          }\n        } else {\n          if (currentDroppable != droppableBelowBack) {\n            if (currentDroppable) {\n              // логика обработки процесса \"вылета\" из finished (удаляем подсветку)\n              leaveDroppable(currentDroppable);\n            }\n\n            currentDroppable = droppableBelowBack;\n\n            if (currentDroppable) {\n              // логика обработки процесса, когда мы \"влетаем\" в элемент finished\n              enterDroppableBack(currentDroppable);\n            }\n          }\n        }\n      }\n\n      document.addEventListener('mousemove', onMouseMove);\n\n      dragItem.onmouseup = e => {\n        //смотрим что \"под\" курсором и под перетаскиваемым элементом\n        dragItem.hidden = true;\n        let elemBelow = document.elementFromPoint(e.clientX, e.clientY);\n        dragItem.hidden = false; //проверка на расположение зоны дропа в нужном месте\n\n        let droppableBelow = elemBelow.closest('.finished');\n        let droppableBelowBak = elemBelow.closest('.not-finished');\n\n        if (currentDroppable === elemBelow && currentDroppable === droppableBelow) {\n          // console.log('курсор находится над ЗЕЛЁНОЙ зоной дропа и мышь была отпущена');\n          taskComplete(dragItem.id);\n          dragItem.remove();\n        }\n\n        if (elemBelow === droppableBelowBak) {\n          // console.log('курсор находится над крассной зоной дропа и мышь была отпущена');\n          taskComplete(dragItem.id);\n          dragItem.remove();\n        } // console.log(currentDroppable);// текущая зона для дропа\n        // console.log(elemBelow); //элемент который \"снизу\" под курсором во время отжатия клавиши\n        // console.log(droppableBelow);// элемент в котором лежит зона дропа (проверка на \"родителя\" = finished )\n\n\n        document.removeEventListener('mousemove', onMouseMove);\n        dragItem.onmouseup = null;\n      };\n    };\n\n    function enterDroppable(elem) {\n      elem.style.background = '#afe892';\n    }\n\n    function enterDroppableBack(elem) {\n      elem.style.background = 'pink';\n    }\n\n    function leaveDroppable(elem) {\n      elem.style.background = '';\n    }\n  };\n\n  const style = {\n    span: {\n      display: 'block',\n      width: '200px',\n      padding: 0,\n      listStyleType: 'none',\n      textAlign: 'left'\n    }\n  };\n  return React.createElement(\"span\", {\n    className: \"taskItem\",\n    style: style.span,\n    onMouseOver: dragNDrop,\n    id: task.id,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }, index + 1, \" \", task.title, \" \", task.completed.toLocaleString());\n};\n\nconst mapDispatchToProps = {\n  taskComplete\n};\nexport default connect(null, mapDispatchToProps)(TaskItem);","map":{"version":3,"sources":["/home/evgeny/Public/reduxtraine/my-app/src/views/pages/Trello/TaskItem.js"],"names":["React","connect","taskComplete","TaskItem","task","index","dragNDrop","e","dragItem","target","ondragstart","currentDroppable","onmousedown","style","position","zIndex","shiftX","clientX","getBoundingClientRect","left","shiftY","clientY","top","taskList","document","getElementsByClassName","append","moveAt","pageX","pageY","onMouseMove","console","log","hidden","elemBelow","elementFromPoint","droppableBelow","closest","droppableBelowBack","leaveDroppable","enterDroppable","enterDroppableBack","addEventListener","onmouseup","droppableBelowBak","id","remove","removeEventListener","elem","background","span","display","width","padding","listStyleType","textAlign","title","completed","toLocaleString","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { connect } from 'react-redux';\nimport {taskComplete} from '../../../state/ducks/task/actions'\n\n\nconst TaskItem = ({task, index, taskComplete}) =>{\n  const dragNDrop = (e) => {\n    const dragItem = e.target;\n    \n    dragItem.ondragstart = function() {\n      return false;\n    };\n    let currentDroppable = null;\n    \n    dragItem.onmousedown = e => {\n      dragItem.style.position = 'relative'\n      dragItem.style.zIndex = 1000;\n  \n      let shiftX = e.clientX - dragItem.getBoundingClientRect().left;\n      let shiftY = e.clientY - dragItem.getBoundingClientRect().top;\n  \n      let taskList = document.getElementsByClassName('taskList')[0]\n      taskList.append(dragItem);\n  \n      moveAt(e.pageX, e.pageY);\n      \n      function moveAt(pageX, pageY){\n        dragItem.style.left = pageX - shiftX +'px'\n        dragItem.style.top = pageY - shiftY +'px'\n      }\n  \n      function onMouseMove(e) {\n        moveAt(e.pageX, e.pageY);\n        console.log(currentDroppable);\n  \n        dragItem.hidden = true;\n        let elemBelow = document.elementFromPoint(e.clientX, e.clientY);\n        dragItem.hidden = false;\n  \n        if (!elemBelow) return;\n  \n        // предположительная точка \"посадки\" Drag’n’Drop функции \n        let droppableBelow = elemBelow.closest('.finished');\n        let droppableBelowBack = elemBelow.closest('.not-finished');\n  \n  \n        if (currentDroppable != droppableBelow) {\n          if (currentDroppable) {\n            // логика обработки процесса \"вылета\" из finished (удаляем подсветку)\n            leaveDroppable(currentDroppable);\n          }\n          currentDroppable = droppableBelow;\n          if (currentDroppable) {\n            // логика обработки процесса, когда мы \"влетаем\" в элемент finished\n            enterDroppable(currentDroppable);\n          }\n        } else {\n\n          if (currentDroppable != droppableBelowBack) {\n            if (currentDroppable) {\n              // логика обработки процесса \"вылета\" из finished (удаляем подсветку)\n              leaveDroppable(currentDroppable);\n            }\n            currentDroppable = droppableBelowBack;\n            if (currentDroppable) {\n              // логика обработки процесса, когда мы \"влетаем\" в элемент finished\n              enterDroppableBack(currentDroppable);\n            }\n          }\n        }\n\n      }\n  \n      document.addEventListener('mousemove', onMouseMove);\n  \n      dragItem.onmouseup = (e) => {\n        //смотрим что \"под\" курсором и под перетаскиваемым элементом\n        dragItem.hidden = true;\n        let elemBelow = document.elementFromPoint(e.clientX, e.clientY);\n        dragItem.hidden = false;\n        //проверка на расположение зоны дропа в нужном месте\n        let droppableBelow = elemBelow.closest('.finished');\n        let droppableBelowBak = elemBelow.closest('.not-finished')\n        \n        if(currentDroppable === elemBelow && currentDroppable === droppableBelow){\n          // console.log('курсор находится над ЗЕЛЁНОЙ зоной дропа и мышь была отпущена');\n          taskComplete(dragItem.id)\n          dragItem.remove();\n        }\n        if(elemBelow === droppableBelowBak){\n          // console.log('курсор находится над крассной зоной дропа и мышь была отпущена');\n          taskComplete(dragItem.id)\n          dragItem.remove();\n        }\n        \n        // console.log(currentDroppable);// текущая зона для дропа\n        // console.log(elemBelow); //элемент который \"снизу\" под курсором во время отжатия клавиши\n        // console.log(droppableBelow);// элемент в котором лежит зона дропа (проверка на \"родителя\" = finished )\n  \n          document.removeEventListener('mousemove', onMouseMove);\n          dragItem.onmouseup = null;\n  \n      };\n    }\n    \n    function enterDroppable(elem) {\n      elem.style.background = '#afe892';\n    }\n  \n    function enterDroppableBack(elem) {\n      elem.style.background = 'pink';\n    }\n    \n    function leaveDroppable(elem) {\n      elem.style.background = '';\n    }\n\n  }\n\n  \n  const style = {\n    span:{\n      display: 'block',\n      width:'200px',\n      padding:0 ,\n      listStyleType:'none',\n      textAlign:'left'\n    }\n  }\n  \n  return(\n  <span className='taskItem'\n      style={style.span}\n      onMouseOver={dragNDrop}\n      id={task.id}>\n        {index+1} {task.title} {task.completed.toLocaleString()}\n  </span>\n    )\n}\n\n\nconst mapDispatchToProps = { taskComplete};\n\nexport default connect(null, mapDispatchToProps)(TaskItem);"]},"metadata":{},"sourceType":"module"}